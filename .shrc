alias ytdl="youtube-dl"
alias c="fasd_cd -d"
alias please="history -1 | awk '{\$1=\"\"; print substr(\$0,2)}' | xargs sudo"
alias rand="LC_ALL=C tr -dc A-Za-z0-9_ < /dev/urandom | head -c $1"
alias autoremove='sudo pacman -Rcns $(pacman -Qdtq)'
alias packer="packer --noedit"
alias pbin="curl -T - https://p.iotek.org"
alias diff="diff --color=auto"

function conntmux
{
	ssh "$1" -t "tmux attach -t \"$2\""
	if [ "$?" != 0 ]; then
		echo -n "The '$2' session doesn't exist. Create it? [Y/n] "
		read reply
		if [ "$reply" = "" ] || [ "$reply" = "y" ] || [ "$reply" = "Y" ]; then
			ssh "$1" -t "tmux new -s \"$2\""
		else
			echo "Exiting."
			return 1
		fi
	fi
}
for name in elli weblet testlet minelet; do
	alias "$name"="conntmux $name"
done

function cddots
{
	cd "$1"
	[ "$2" != "" ] && cd "$2"
	return 0
}
dots=".."
ups="../"
for i in {1..20}; do
	alias "$dots"="cddots $ups"
	dots="$dots."
	ups="$ups../"
done
dots=""
ups=""
alias ","="cd"

function mkcd
{
	DIR="$1"
	mkdir -p "$DIR"
	cd "$DIR"
}

function cpt
{
	if [ "$1" = "" ]; then
		echo "Usage: $0 <host>"
		return 1
	fi
	scp -r . "${1}:tmp2"
	ssh -t "$1" 'rm -rf ~/tmp; mv ~/tmp2 ~/tmp; cd ~/tmp; bash'
}

function pack
{
	if [ "$1" = "" ]; then
		NAME="martindn"
	else
		NAME="$1"
	fi
	rm "$NAME.tgz"
	DIR=$(pwd)
	TMP=$(mktemp -d /tmp/pack.XXXXXXXXXX)
	cp -r * "$TMP"
	cd "$TMP"
	mkdir "$NAME"
	mv * "$NAME" 2>/dev/null
	tar -czvf "$NAME.tgz" "$NAME"
	cd "$DIR"
	mv "$TMP/$NAME.tgz" .
	rm -rf "$TMP"
}

if [ ! "$TMUX" = "" ]; then
	export TERM="xterm-256color"
fi

function cd
{
	builtin cd "$@"
	pwd > ~/.lastdir
}

if [ -f ~/.lastdir ]; then
	cd "$(cat ~/.lastdir)"
fi

if [ -f ~/.shrc-local ]; then
	. ~/.shrc-local
fi
